2025-03-12 04:37:24,232	INFO worker.py:1841 -- Started a local Ray instance.
2025-03-12 04:37:28,119	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
2025-03-12 04:37:28,172	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
[36m(train pid=743312)[0m /home/ad2002/ComputationThruDynamicsBenchmark/ctd/task_modeling/task_training.py:69: UserWarning: 
[36m(train pid=743312)[0m The version_base parameter is not specified.
[36m(train pid=743312)[0m Please specify a compatability version level, or None.
[36m(train pid=743312)[0m Will assume defaults for version 1.1
[36m(train pid=743312)[0m   with hydra.initialize(
[36m(train pid=743312)[0m /home/ad2002/ComputationThruDynamicsBenchmark/ctd/task_modeling/task_training.py:69: UserWarning: 
[36m(train pid=743312)[0m The version_base parameter is not specified.
[36m(train pid=743312)[0m Please specify a compatability version level, or None.
[36m(train pid=743312)[0m Will assume defaults for version 1.1
[36m(train pid=743312)[0m   with hydra.initialize(
[36m(train pid=743312)[0m [rank: 0] Seed set to 0
[36m(train pid=743312)[0m /home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/tune/integration/pytorch_lightning.py:198: `ray.tune.integration.pytorch_lightning.TuneReportCallback` is deprecated. Use `ray.tune.integration.pytorch_lightning.TuneReportCheckpointCallback` instead.
[36m(train pid=743312)[0m GPU available: True (cuda), used: True
[36m(train pid=743312)[0m TPU available: False, using: 0 TPU cores
[36m(train pid=743312)[0m HPU available: False, using: 0 HPUs
[36m(train pid=743312)[0m You are using a CUDA device ('NVIDIA A100 80GB PCIe') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[36m(train pid=743312)[0m /home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/lightning_fabric/loggers/csv_logs.py:268: Experiment logs directory ./ exists and is not empty. Previous log files in this directory will be deleted when the new ones are saved!
[36m(train pid=743312)[0m /home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /tmp/ray/session_2025-03-12_04-37-22_747931_740188/artifacts/2025-03-12_04-37-28/train_2025-03-12_04-37-28/working_dirs/0_env_params_noise=0.0000,task_wrapper_learning_rate=0.0100 exists and is not empty.
[36m(train pid=743312)[0m LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[36m(train pid=743312)[0m 
[36m(train pid=743312)[0m   | Name  | Type | Params | Mode 
[36m(train pid=743312)[0m ---------------------------------------
[36m(train pid=743312)[0m 0 | model | NODE | 4.8 K  | train
[36m(train pid=743312)[0m ---------------------------------------
[36m(train pid=743312)[0m 4.8 K     Trainable params
[36m(train pid=743312)[0m 0         Non-trainable params
[36m(train pid=743312)[0m 4.8 K     Total params
[36m(train pid=743312)[0m 0.019     Total estimated model params size (MB)
[36m(train pid=743312)[0m 9         Modules in train mode
[36m(train pid=743312)[0m 0         Modules in eval mode
[36m(train pid=743312)[0m SLURM auto-requeueing enabled. Setting signal handlers.
2025-03-12 04:37:38,296	ERROR tune_controller.py:1331 -- Trial task failed for trial train_37cf8_00000
Traceback (most recent call last):
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(AttributeError): [36mray::ImplicitFunc.train()[39m (pid=743312, ip=172.17.7.5, actor_id=ef0e00862a5e2e7454ca190001000000, repr=train)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/tune/trainable/trainable.py", line 330, in train
    raise skipped from exception_cause(skipped)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/air/_internal/util.py", line 107, in run
    self._ret = self._target(*self._args, **self._kwargs)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/tune/trainable/function_trainable.py", line 45, in <lambda>
    training_func=lambda: self._trainable_func(self.config),
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/tune/trainable/function_trainable.py", line 261, in _trainable_func
    output = fn()
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/tune/trainable/util.py", line 130, in inner
    return trainable(config, **fn_kwargs)
  File "/home/ad2002/ComputationThruDynamicsBenchmark/ctd/task_modeling/task_training.py", line 201, in train
    trainer.fit(model=task_wrapper, datamodule=datamodule)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 539, in fit
    call._call_and_handle_interrupt(
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 575, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1024, in _run_stage
    self._run_sanity_check()
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_sanity_check
    val_loop.run()
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 151, in run
    return self.on_run_end()
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 291, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 370, in _on_evaluation_epoch_end
    call._call_callback_hooks(trainer, hook_name)
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 222, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "/home/ad2002/ComputationThruDynamicsBenchmark/ctd/task_modeling/callbacks/callbacks.py", line 97, in on_validation_epoch_end
    logger.log({"state_plot": wandb.Image(fig), "global_step": trainer.global_step})
AttributeError: 'NoneType' object has no attribute 'log'
2025-03-12 04:37:38,307	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/scratch/gpfs/ad2002/content/runs/task-trained/20250312_3BFF_node_March_12/train_2025-03-12_04-37-28' in 0.0056s.
Traceback (most recent call last):
  File "/home/ad2002/ComputationThruDynamicsBenchmark/examples/task_training/3bff_node.py", line 92, in <module>
    main(
  File "/home/ad2002/ComputationThruDynamicsBenchmark/examples/task_training/3bff_node.py", line 67, in main
    tune.run(
  File "/home/ad2002/.conda/envs/ctd/lib/python3.10/site-packages/ray/tune/tune.py", line 1035, in run
    raise TuneError("Trials did not complete", incomplete_trials)
ray.tune.error.TuneError: ('Trials did not complete', [train_37cf8_00000])
